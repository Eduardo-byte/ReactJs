{"ast":null,"code":"import React from 'react';\nconst PRODUCTS = '_PRODUCTS';\nexport function ErrorValidation(errors) {\n  this.errors = errors;\n}\nexport default class ProductService {\n  constructor() {\n    this.validation = product => {\n      const errors = [];\n\n      if (!product.name) {\n        errors.push(\"Name field is required\");\n      }\n\n      let link = window.location.href;\n      this.list().forEach((value, i) => {\n        if (value.sku === product.sku && !link.includes(\"/\" + value.sku)) {\n          errors.push(\"SKU field already exists\");\n        }\n      });\n\n      if (!product.sku) {\n        errors.push(\"SKU field is required\");\n      }\n\n      if (!product.description) {\n        errors.push(\"Description field is required\");\n      }\n\n      if (!product.price || product.price <= 0) {\n        errors.push(\"Price field needs to be bigger than zero(0)\");\n      }\n\n      if (!product.suplier) {\n        errors.push(\"Suplier field is required\");\n      }\n\n      if (errors.length > 0) {\n        throw new ErrorValidation(errors);\n      }\n    };\n\n    this.list = product => {\n      const products = localStorage.getItem(PRODUCTS);\n\n      if (!products) {\n        return [];\n      }\n\n      return JSON.parse(products);\n    };\n\n    this.getIndex = sku => {\n      let index = null;\n\n      if (this.list.length > 0) {\n        this.list().forEach((product, i) => {\n          if (product.sku === sku) {\n            index = i;\n          }\n        });\n      }\n\n      return index;\n    };\n\n    this.delete = sku => {\n      const index = this.getIndex(sku);\n\n      if (index !== null) {\n        const products = this.list();\n        products.splice(index, 1);\n      }\n    };\n\n    this.save = product => {\n      this.validation(product);\n      let products = localStorage.getItem(PRODUCTS);\n\n      if (!products) {\n        products = [];\n      } else {\n        products = JSON.parse(products);\n      }\n\n      const index = this.getIndex(product.sku);\n\n      if (index === null) {\n        products.push(product);\n      } else {\n        products[index] = product;\n      }\n\n      localStorage.setItem(PRODUCTS, JSON.stringify(products));\n    };\n  }\n\n}","map":{"version":3,"sources":["/home/eduardo/react-projects/register-products/src/app/productService.js"],"names":["React","PRODUCTS","ErrorValidation","errors","ProductService","validation","product","name","push","link","window","location","href","list","forEach","value","i","sku","includes","description","price","suplier","length","products","localStorage","getItem","JSON","parse","getIndex","index","delete","splice","save","setItem","stringify"],"mappings":"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","sourcesContent":["import React from 'react'\n\nconst PRODUCTS = '_PRODUCTS'\n\nexport function ErrorValidation(errors){\n    this.errors = errors;\n}\n\nexport default class ProductService{\n\n    validation = (product) => {\n        const errors = []\n\n        if(!product.name){\n            errors.push(\"Name field is required\")\n        }\n\n        let link = window.location.href\n            this.list().forEach( (value ,i) => {\n                if(value.sku === product.sku && !link.includes(\"/\" + value.sku)){\n                    errors.push(\"SKU field already exists\")\n                }\n            })\n        \n        if(!product.sku){\n            errors.push(\"SKU field is required\")\n        }\n\n        if(!product.description){\n            errors.push(\"Description field is required\")\n        }\n\n        if(!product.price || product.price <= 0){\n            errors.push(\"Price field needs to be bigger than zero(0)\")\n        }\n\n        if(!product.suplier){\n            errors.push(\"Suplier field is required\")\n        }\n\n        if(errors.length > 0){\n            throw new ErrorValidation(errors)\n        }\n    }\n\n\n    list = (product) => {\n        const products = localStorage.getItem(PRODUCTS)\n        if(!products){\n            return []\n        }\n        return JSON.parse(products)\n    }\n\n    getIndex = (sku) => {\n        let index = null;\n        if(this.list.length > 0){\n            this.list().forEach( (product ,i ) => {\n                if(product.sku === sku){\n                    index = i;\n                }\n            })\n        }\n        return index;\n    }\n\n    delete = (sku) => {\n        const index = this.getIndex(sku)\n        if(index !==null){\n            const products = this.list()\n            products.splice(index , 1)\n        }\n    }\n\n    save = (product) => {\n            this.validation(product)\n            let products = localStorage.getItem(PRODUCTS)\n            \n            if (!products) {\n                products = []\n            }else{\n                products = JSON.parse(products)\n            }\n    \n            const index = this.getIndex(product.sku)\n    \n            if (index === null){\n                products.push(product);\n            }else{\n               products[index] = product;\n            }\n            localStorage.setItem(PRODUCTS , JSON.stringify(products))\n            \n        }\n        \n}"]},"metadata":{},"sourceType":"module"}